(this["webpackJsonptic-tac-toe-front"]=this["webpackJsonptic-tac-toe-front"]||[]).push([[0],{119:function(e,n,t){e.exports=t(221)},124:function(e,n,t){},184:function(e,n,t){"use strict";t.r(n);var a=function(){var e={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},n={kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null},t=[{kind:"LinkedField",alias:null,name:"viewer",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[e,n,{kind:"LinkedField",alias:null,name:"currentRoom",storageKey:null,args:null,concreteType:"Room",plural:!1,selections:[e,n,{kind:"ScalarField",alias:null,name:"gameActive",args:null,storageKey:null}]}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"viewerQuery",type:"Query",metadata:null,argumentDefinitions:[],selections:t},operation:{kind:"Operation",name:"viewerQuery",argumentDefinitions:[],selections:t},params:{operationKind:"query",name:"viewerQuery",id:null,text:"query viewerQuery {\n  viewer {\n    id\n    name\n    currentRoom {\n      id\n      name\n      gameActive\n    }\n  }\n}\n",metadata:{}}}}();a.hash="5fe46b1806d1782fb79fec17d593f2c9",n.default=a},185:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LocalArgument",name:"input",type:"createUserInput!",defaultValue:null}],n=[{kind:"ScalarField",alias:"token",name:"createUser",args:[{kind:"Variable",name:"input",variableName:"input"}],storageKey:null}];return{kind:"Request",fragment:{kind:"Fragment",name:"createUserMutation",type:"Mutation",metadata:null,argumentDefinitions:e,selections:n},operation:{kind:"Operation",name:"createUserMutation",argumentDefinitions:e,selections:n},params:{operationKind:"mutation",name:"createUserMutation",id:null,text:"mutation createUserMutation(\n  $input: createUserInput!\n) {\n  token: createUser(input: $input)\n}\n",metadata:{}}}}();a.hash="f32510d4c88ba6c5b07a66503bbd705d",n.default=a},186:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LocalArgument",name:"name",type:"String!",defaultValue:null}],n=[{kind:"LinkedField",alias:null,name:"createRoom",storageKey:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"Room",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"createRoomMutation",type:"Mutation",metadata:null,argumentDefinitions:e,selections:n},operation:{kind:"Operation",name:"createRoomMutation",argumentDefinitions:e,selections:n},params:{operationKind:"mutation",name:"createRoomMutation",id:null,text:"mutation createRoomMutation(\n  $name: String!\n) {\n  createRoom(name: $name) {\n    id\n  }\n}\n",metadata:{}}}}();a.hash="67f4d1bdc244fb594833a0d2bfac4db6",n.default=a},188:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LocalArgument",name:"id",type:"ID!",defaultValue:null}],n=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"ScalarField",alias:null,name:"gameActive",args:null,storageKey:null};return{kind:"Request",fragment:{kind:"Fragment",name:"enterRoomMutation",type:"Mutation",metadata:null,argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"enterRoom",storageKey:null,args:n,concreteType:"Room",plural:!1,selections:[t]}]},operation:{kind:"Operation",name:"enterRoomMutation",argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"enterRoom",storageKey:null,args:n,concreteType:"Room",plural:!1,selections:[t,{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null}]}]},params:{operationKind:"mutation",name:"enterRoomMutation",id:null,text:"mutation enterRoomMutation(\n  $id: ID!\n) {\n  enterRoom(id: $id) {\n    gameActive\n    id\n  }\n}\n",metadata:{}}}}();a.hash="ac01245e124a91f83b0ed1dc4a860376",n.default=a},189:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LocalArgument",name:"input",type:"makeStepInput!",defaultValue:null}],n=[{kind:"LinkedField",alias:null,name:"makeStep",storageKey:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Board",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"currentPlayer",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null}]}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"makeStepMutation",type:"Mutation",metadata:null,argumentDefinitions:e,selections:n},operation:{kind:"Operation",name:"makeStepMutation",argumentDefinitions:e,selections:n},params:{operationKind:"mutation",name:"makeStepMutation",id:null,text:"mutation makeStepMutation(\n  $input: makeStepInput!\n) {\n  makeStep(input: $input) {\n    currentPlayer {\n      id\n    }\n  }\n}\n",metadata:{}}}}();a.hash="2f05ad08e2c18819ef18a051916df8f1",n.default=a},190:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"ScalarField",alias:null,name:"x",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"y",args:null,storageKey:null}],n={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},t=[n],a=[{kind:"LinkedField",alias:null,name:"waitBoardChange",storageKey:null,args:null,concreteType:"Board",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"lastStep",storageKey:null,args:null,concreteType:"Cell",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"position",storageKey:null,args:null,concreteType:"Position",plural:!1,selections:e},{kind:"LinkedField",alias:null,name:"owner",storageKey:null,args:null,concreteType:"User",plural:!1,selections:t}]},{kind:"LinkedField",alias:null,name:"possibleSteps",storageKey:null,args:null,concreteType:"Position",plural:!0,selections:e},{kind:"LinkedField",alias:null,name:"currentPlayer",storageKey:null,args:null,concreteType:"User",plural:!1,selections:t},{kind:"LinkedField",alias:null,name:"winner",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[n,{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null}]},{kind:"LinkedField",alias:null,name:"winnerLine",storageKey:null,args:null,concreteType:"Position",plural:!0,selections:e}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"GameBoardSubscription",type:"Subscription",metadata:null,argumentDefinitions:[],selections:a},operation:{kind:"Operation",name:"GameBoardSubscription",argumentDefinitions:[],selections:a},params:{operationKind:"subscription",name:"GameBoardSubscription",id:null,text:"subscription GameBoardSubscription {\n  waitBoardChange {\n    lastStep {\n      position {\n        x\n        y\n      }\n      owner {\n        id\n      }\n    }\n    possibleSteps {\n      x\n      y\n    }\n    currentPlayer {\n      id\n    }\n    winner {\n      id\n      name\n    }\n    winnerLine {\n      x\n      y\n    }\n  }\n}\n",metadata:{}}}}();a.hash="00245dc117fa0a2f6778df27d8558698",n.default=a},191:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LinkedField",alias:null,name:"userExit",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"GameBoardUserExitSubscription",type:"Subscription",metadata:null,argumentDefinitions:[],selections:e},operation:{kind:"Operation",name:"GameBoardUserExitSubscription",argumentDefinitions:[],selections:e},params:{operationKind:"subscription",name:"GameBoardUserExitSubscription",id:null,text:"subscription GameBoardUserExitSubscription {\n  userExit {\n    id\n    name\n  }\n}\n",metadata:{}}}}();a.hash="c1a2e315a9612fb2e74201a175cd5836",n.default=a},192:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LocalArgument",name:"roomId",type:"ID!",defaultValue:null}],n=[{kind:"LinkedField",alias:"room",name:"getRoom",storageKey:null,args:[{kind:"Variable",name:"id",variableName:"roomId"}],concreteType:"Room",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"gameActive",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"roomQueryForRoomQuery",type:"Query",metadata:null,argumentDefinitions:e,selections:n},operation:{kind:"Operation",name:"roomQueryForRoomQuery",argumentDefinitions:e,selections:n},params:{operationKind:"query",name:"roomQueryForRoomQuery",id:null,text:"query roomQueryForRoomQuery(\n  $roomId: ID!\n) {\n  room: getRoom(id: $roomId) {\n    id\n    name\n    gameActive\n  }\n}\n",metadata:{}}}}();a.hash="255e79af990d585908e239a876fdc93f",n.default=a},193:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"ScalarField",alias:null,name:"exitRoom",args:null,storageKey:null}];return{kind:"Request",fragment:{kind:"Fragment",name:"exitRoomMutation",type:"Mutation",metadata:null,argumentDefinitions:[],selections:e},operation:{kind:"Operation",name:"exitRoomMutation",argumentDefinitions:[],selections:e},params:{operationKind:"mutation",name:"exitRoomMutation",id:null,text:"mutation exitRoomMutation {\n  exitRoom\n}\n",metadata:{}}}}();a.hash="27f13537946efa85f8922b47205c4afc",n.default=a},194:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"ScalarField",alias:null,name:"x",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"y",args:null,storageKey:null}],n={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},t=[n],a=[{kind:"LinkedField",alias:null,name:"position",storageKey:null,args:null,concreteType:"Position",plural:!1,selections:e},{kind:"LinkedField",alias:null,name:"owner",storageKey:null,args:null,concreteType:"User",plural:!1,selections:t}],r=[n,{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null}],l=[{kind:"LinkedField",alias:null,name:"board",storageKey:null,args:null,concreteType:"Board",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"cells",storageKey:null,args:null,concreteType:"Cell",plural:!0,selections:a},{kind:"LinkedField",alias:null,name:"possibleSteps",storageKey:null,args:null,concreteType:"Position",plural:!0,selections:e},{kind:"LinkedField",alias:null,name:"lastStep",storageKey:null,args:null,concreteType:"Cell",plural:!1,selections:a},{kind:"LinkedField",alias:null,name:"order",storageKey:null,args:null,concreteType:"User",plural:!0,selections:r},{kind:"LinkedField",alias:null,name:"winner",storageKey:null,args:null,concreteType:"User",plural:!1,selections:r},{kind:"LinkedField",alias:null,name:"winnerLine",storageKey:null,args:null,concreteType:"Position",plural:!0,selections:e},{kind:"LinkedField",alias:null,name:"currentPlayer",storageKey:null,args:null,concreteType:"User",plural:!1,selections:t}]},{kind:"LinkedField",alias:null,name:"viewer",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[n,{kind:"LinkedField",alias:null,name:"currentRoom",storageKey:null,args:null,concreteType:"Room",plural:!1,selections:t}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"GameQuery",type:"Query",metadata:null,argumentDefinitions:[],selections:l},operation:{kind:"Operation",name:"GameQuery",argumentDefinitions:[],selections:l},params:{operationKind:"query",name:"GameQuery",id:null,text:"query GameQuery {\n  board {\n    cells {\n      position {\n        x\n        y\n      }\n      owner {\n        id\n      }\n    }\n    possibleSteps {\n      x\n      y\n    }\n    lastStep {\n      position {\n        x\n        y\n      }\n      owner {\n        id\n      }\n    }\n    order {\n      id\n      name\n    }\n    winner {\n      id\n      name\n    }\n    winnerLine {\n      x\n      y\n    }\n    currentPlayer {\n      id\n    }\n  }\n  viewer {\n    id\n    currentRoom {\n      id\n    }\n  }\n}\n",metadata:{}}}}();a.hash="0c97c77bee1ffe415edbaec4486008f8",n.default=a},219:function(e,n,t){"use strict";t.r(n);var a=function(){var e=[{kind:"LocalArgument",name:"ready",type:"Boolean!",defaultValue:null}],n=[{kind:"Variable",name:"ready",variableName:"ready"}],t={kind:"ScalarField",alias:null,name:"gameActive",args:null,storageKey:null};return{kind:"Request",fragment:{kind:"Fragment",name:"setReadyMutation",type:"Mutation",metadata:null,argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"setReady",storageKey:null,args:n,concreteType:"Room",plural:!1,selections:[t]}]},operation:{kind:"Operation",name:"setReadyMutation",argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"setReady",storageKey:null,args:n,concreteType:"Room",plural:!1,selections:[t,{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null}]}]},params:{operationKind:"mutation",name:"setReadyMutation",id:null,text:"mutation setReadyMutation(\n  $ready: Boolean!\n) {\n  setReady(ready: $ready) {\n    gameActive\n    id\n  }\n}\n",metadata:{}}}}();a.hash="02e961b3e69ede717dcf0c1de93cbd00",n.default=a},220:function(e,n,t){"use strict";t.r(n);var a=function(){var e={kind:"ScalarField",alias:null,name:"gameActive",args:null,storageKey:null};return{kind:"Request",fragment:{kind:"Fragment",name:"WaitPlayerSubscription",type:"Subscription",metadata:null,argumentDefinitions:[],selections:[{kind:"LinkedField",alias:null,name:"waitForOtherUser",storageKey:null,args:null,concreteType:"Room",plural:!1,selections:[e]}]},operation:{kind:"Operation",name:"WaitPlayerSubscription",argumentDefinitions:[],selections:[{kind:"LinkedField",alias:null,name:"waitForOtherUser",storageKey:null,args:null,concreteType:"Room",plural:!1,selections:[e,{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null}]}]},params:{operationKind:"subscription",name:"WaitPlayerSubscription",id:null,text:"subscription WaitPlayerSubscription {\n  waitForOtherUser {\n    gameActive\n    id\n  }\n}\n",metadata:{}}}}();a.hash="5bef5d6bffa8ea388cdfd500e37d269a",n.default=a},221:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),l=t(105),i=t.n(l),o=(t(124),t(4)),u=t(24),c=t(3),s=t.n(c),m=t(6),d=t(10),f=t(11);function p(){var e=Object(d.a)(["\n  padding: 12rem;\n  & "," {\n    margin: auto;\n    max-width: 720px;\n  }\n"]);return p=function(){return e},e}function g(){var e=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n  * {\n    margin: 0.5rem;\n  }\n"]);return g=function(){return e},e}function y(){var e=Object(d.a)(["\n  padding: 0.5rem;\n  font-family: monospace;\n"]);return y=function(){return e},e}function b(){var e=Object(d.a)(["\n  display: inline-block;\n  padding: 0.5rem;\n  font-family: monospace;\n"]);return b=function(){return e},e}function v(){var e=Object(d.a)(["\n  display: inline-block;\n  min-width: 100%;\n  margin: 4rem auto;\n  font-family: monospace;\n  text-align: center;\n  font-weight: 400;\n"]);return v=function(){return e},e}function k(){var e=Object(d.a)(["\n  width: 100vw;\n  height: 100vh;\n"]);return k=function(){return e},e}var h=f.a.div(k()),E=function(){return null};E.h2=f.a.h2(v());var w=f.a.button(b()),x=f.a.input(y()),S=f.a.form(g()),F=f.a.div(p(),S),R=function(e){var n=e.children;return r.a.createElement(F,null,r.a.createElement(S,null,n))},O=function(e){window.localStorage.setItem("auth-token",e)},K=function(){return window.localStorage.getItem("auth-token")||""},j=t(40),C=t(55),L=t(109),M=t(45),T=t(13),D=new M.SubscriptionClient("ws://192.168.1.135:4000/graphql",{reconnect:!0}),U={applyMiddleware:function(e,n){e.authorization=K(),n()}};D.use([U]);var P=new L.a(D),q=T.Network.create((function(e,n){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("http://192.168.1.135:4000/graphql",{method:"POST",headers:{authorization:K(),"content-type":"application/json"},body:JSON.stringify({query:e.text,variables:n})}).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}))}),(function(e,n){return Object(C.b)(P,{query:e.text,variables:n})})),A=new T.Store(new T.RecordSource),B=new T.Environment({network:q,store:A}),Q=function(e){var n=e.mutation,t=e.variables;return new Promise((function(e,a){Object(j.commitMutation)(B,{mutation:n,variables:t||{},onCompleted:function(n,t){t&&a(t),e(n)},onError:a})}))},I=function(e){var n=e.subscription,t=e.variables,a=e.onCompleted,r=e.onNext,l=e.onError;return Object(j.requestSubscription)(B,{subscription:n,variables:t||{},onCompleted:a,onError:l,onNext:r})},V=function(){return t(184)},G={update:function(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}))},viewer:null},N=r.a.createContext(G),$=function(e){var n=e.children,t=r.a.useState(null),a=Object(m.a)(t,2),l=a[0],i=a[1],o=r.a.useRef(null),u=r.a.useCallback((function(){return o.current?o.current:(o.current=function(e){var n=e.query,t=e.variables;return Object(j.fetchQuery)(B,n,t)}({query:V}).then((function(e){var n=e.viewer;return o.current=null,i(n),n}),(function(e){console.error(e),o.current=null,i(null)})),o.current)}),[o,i]);r.a.useEffect((function(){null===l&&u()}),[l,u]);var c=r.a.useMemo((function(){return r.a.createElement(N.Provider,{value:{update:u,viewer:l}},n)}),[u,l,n]);return null===o.current?c:r.a.createElement(r.a.Fragment,null,"Loading...")},z=N,W=function(){return t(185)},J=function(e){return Q({mutation:W,variables:{input:e}})},H=function(){return t(186)},Y=function(e){return Q({mutation:H,variables:e})},X=Object(u.g)((function(e){var n=e.history,t=r.a.createRef(),a=r.a.createRef(),l=r.a.useState(!1),i=Object(m.a)(l,2),o=i[0],u=i[1],c=r.a.useContext(z).update;return r.a.createElement(h,null,r.a.createElement(R,null,r.a.createElement(x,{placeholder:"User name",ref:t}),r.a.createElement(x,{placeholder:"Room name",ref:a}),r.a.createElement(w,{onClick:function(e){e.preventDefault(),t.current&&a.current&&""!==t.current.value&&""!==a.current.value&&(Promise.resolve({user:t.current.value,room:a.current.value}).then((function(e){var t,a,r,l,i,o;return s.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.user,a=e.room,m.next=3,s.a.awrap(J({name:t}));case 3:return r=m.sent,l=r.token,O(l),m.next=8,s.a.awrap(Y({name:a}));case 8:i=m.sent,o=i.createRoom.id,u(!1),n.push("/"+o),c();case 13:case"end":return m.stop()}}))})).catch((function(e){console.error(e),u(!1)})),u(!0))},disabled:o}," Create room ")))})),Z=t(56),_=function(){return t(188)},ee=function(e){return Q({mutation:_,variables:e})},ne=t(12),te=function(e){var n=e.query,t=e.render,a=e.renderNull,l=e.renderError,i=e.variables,o=Object(Z.a)(e,["query","render","renderNull","renderError","variables"]);return r.a.createElement(j.QueryRenderer,{query:n,render:function(e){var n=e.error,r=e.props;return n&&(console.error(n),l)?l(n):r?t(Object(ne.a)({},o,{},r)):a?a():null},environment:B,variables:i||{}})},ae=t(116),re=function(){return t(189)},le=t(54),ie=function(e){var n=["o","x"],t=e.order.reduce((function(e,t,a){var r=t.id;return Object(ne.a)({},e,Object(le.a)({},r,n[a%n.length]))}),{}),a=e.possibleSteps;0===a.length&&(a=e.cells.map((function(e){return e.position})));var r=a.reduce((function(e,n){var t=e.min,a=e.max,r=n.x,l=n.y;return{min:{x:Math.min(r,t.x),y:Math.min(l,t.y)},max:{x:Math.max(r,a.x),y:Math.max(l,a.y)}}}),{min:{x:0,y:0},max:{x:0,y:0}}),l=r.min,i=r.max;return{symbols:t,offset:l,size:{x:i.x-l.x+1,y:i.y-l.y+1}}},oe=function(e,n){var t=n.x,a=n.y,r=e.offset,l=e.size;return t===r.x-1&&(r.x-=1,l.x+=1),a===r.y-1&&(r.y-=1,l.y+=1),t===l.x+r.x&&(l.x+=1),a===l.y+r.y&&(l.y+=1),Object(ne.a)({},e,{size:Object(ne.a)({},l),offset:Object(ne.a)({},r)})},ue=t(114);function ce(){var e=Object(d.a)(["\n  display: grid;\n  justify-items: center;\n  align-items: center;\n  justify-content: center;\n  align-content: center;\n\n  min-height: 100vh;\n  padding: 2rem;\n  font-family: monospace;\n  color: #222;\n  font-size: 4rem;\n  text-align: center;\n"]);return ce=function(){return e},e}function se(){var e=Object(d.a)(["\n  padding: 0;\n  background-color: #EEE;\n  outline: none;\n  cursor: pointer;\n\n  font-family: monospace;\n  color: rgba(0,0,0,0.6);\n  text-align: center;\n\n  &:hover {\n      background-color: #BFB;\n  }\n  ","\n  }\n"]);return se=function(){return e},e}function me(){var e=Object(d.a)(["\n  position: relative;\n  top: 1px;\n  left: 1px;\n  width: calc(100% + 2px);\n  height: calc(100% + 2px);\n  border: 2px solid gray;\n  line-height: 4rem;\n  ","\n"]);return me=function(){return e},e}var de=f.a.div(me(),(function(e){return e.highlight&&"background-color: #FF3;"})),fe=Object(f.a)(de)(se(),(function(e){return e.children&&"background-color: #BFB;"})),pe=f.a.div(ce()),ge=function(e){var n=e.viewer,t=e.selected,a=e.onSelect,l=e.board,i=e.view,o=i.offset,u=i.size,c=i.symbols,s=r.a.useMemo((function(){return l.cells.map((function(e){var n=e.position,t=n.x,a=n.y,i=e.owner.id;return r.a.createElement(de,{key:"".concat(t,";").concat(a,":").concat(i),style:{gridColumn:t-o.x+2,gridRow:a-o.y+2},highlight:null!==l.lastStep&&t===l.lastStep.position.x&&a===l.lastStep.position.y||null!==l.winnerLine&&l.winnerLine.findIndex((function(e){return e.x===t&&e.y===a}))>=0},c[i])}))}),[l,o,c]),m=r.a.useMemo((function(){return l.currentPlayer&&l.currentPlayer.id===n.id&&l.possibleSteps.map((function(e){var l=e.x,i=e.y;return r.a.createElement(fe,{key:"".concat(l,";").concat(i),style:{gridColumn:l-o.x+2,gridRow:i-o.y+2},onClick:function(e){a({x:l,y:i}),e.stopPropagation()},onTouchEnd:function(e){a({x:l,y:i}),e.stopPropagation()},children:null!==t&&l===t.x&&i===t.y&&c[n.id]})}))}),[t,a,l,o,c,n]);return r.a.createElement(ue.MapInteractionCSS,{containerAsEventTarget:!0},r.a.createElement(pe,{style:{gridTemplateColumns:"repeat(".concat(u.x+2,", 4rem)"),gridTemplateRows:"repeat(".concat(u.y+2,", 4rem)"),transform:"translate(".concat(4*o.x+2*(u.x-1),"rem, ").concat(4*o.y+2*(u.y-1),"rem)")}},s,m))};function ye(){var e=Object(d.a)(["\n  width: 100%;\n  border: 4px solid #3F3;\n  border-radius: 4px;\n"]);return ye=function(){return e},e}function be(){var e=Object(d.a)(["\n  position: fixed;\n  top: 0;\n\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n\n  width: 100%;\n\n  font-family: monospace;\n  font-weight: 400;\n\n  & > div {\n    display: flex;\n    flex-direction: column;\n    padding: 1rem;\n  }\n  & span {\n    padding: 0 1rem;\n    font-size: 2rem;\n  }\n  & label {\n    font-size: 1rem;\n  }\n"]);return be=function(){return e},e}function ve(){var e=Object(d.a)(["\n  position: fixed;\n  top: 100%;\n  left: 50%;\n  padding: 1rem 1rem;\n  min-width: 10rem;\n\n  background-color: #CEC;\n  outline: none;\n  border-radius: 0.5rem;\n\n  font-family: monospace;\n  text-align: center;\n  color: black;\n  font-size: 1rem;\n\n  cursor: pointer;\n\n  &:disabled {\n    opacity: 0.3;\n    cursor: default;\n  }\n\n  transform: translate(-50%, -100%) translateY(-2rem);\n"]);return ve=function(){return e},e}var ke=f.a.button(ve()),he=f.a.div(be()),Ee=f.a.div(ye()),we=function(e){var n=e.players,t=e.symbols,a=e.current;return r.a.createElement(he,null,n.map((function(e,n){var l=e.id,i=e.name;return r.a.createElement("div",{key:l,style:{textAlign:0===n?"left":"right"}},r.a.createElement("span",null,t[l]),r.a.createElement("label",null,i),l===a&&r.a.createElement(Ee,null))})))},xe=function(){return t(190)},Se=function(){return t(191)},Fe=function(e){var n=r.a.useState({board:e.board,selected:null,busy:!1,view:ie(e.board)}),t=Object(m.a)(n,2),a=t[0],l=t[1];r.a.useEffect((function(){return I({subscription:xe,onNext:function(e){var n=e.waitBoardChange;n?l((function(e){return Object(ne.a)({},e,{board:Object(ne.a)({},e.board,{},n,{cells:[].concat(Object(ae.a)(e.board.cells),[n.lastStep])}),view:oe(e.view,n.lastStep.position)})})):console.error("@game Board is null")}}).dispose}),[e.board]);var i=e.onUserExit;r.a.useEffect((function(){return I({subscription:Se,onNext:function(e){var n=e.userExit;n&&(console.log("Oh no ".concat(n.name," exited room :(")),i({user:n}))}}).dispose}),[i]);var u=function(e){l(Object(ne.a)({},a,{busy:!0})),function(e){return Q({mutation:re,variables:{input:e}})}(e).then((function(e){if(!e.makeStep)throw new Error("makeStep response is null");l((function(e){return Object(ne.a)({},e,{busy:!1,selected:null})}))})).catch((function(e){console.error(e),l((function(e){return Object(ne.a)({},e,{busy:!1})}))}))},c=a.selected,s=r.a.useMemo((function(){return r.a.createElement(we,{players:a.board.order.slice().sort((function(n){return n.id===e.viewer.id?-1:1})),symbols:a.view.symbols,current:a.board.currentPlayer?a.board.currentPlayer.id:void 0})}),[a.board.currentPlayer,e.viewer,a.board.order,a.view.symbols]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,{board:a.board,view:a.view,selected:a.selected,viewer:e.viewer,onSelect:function(e){return l(Object(ne.a)({},a,{selected:e}))}}),s,a.board.winner?r.a.createElement(o.b,{to:"/".concat(e.viewer.currentRoom.id)},r.a.createElement(ke,null,"Restart")):r.a.createElement(ke,{onClick:function(){return c&&u(c)},onTouchEnd:function(){return c&&u(c)},disabled:!c||a.busy},"Make turn"))},Re=function(){return t(192)},Oe=function(e){return function(n){return r.a.createElement(te,Object.assign({query:Re},n,{render:function(n){return e(Object(ne.a)({},n))}}))}},Ke=function(e){var n=e.room;return r.a.createElement(h,null,r.a.createElement(E.h2,null,'Game in room "',n.name,'" has already started'))},je=function(e){var n=e.room,t=r.a.useState(!1),a=Object(m.a)(t,2),l=a[0],i=a[1],o=r.a.createRef(),u=r.a.useContext(z).update;return r.a.createElement(h,null,r.a.createElement(R,null,r.a.createElement(E.h2,null,'Enter room "',n.name,'"'),r.a.createElement(x,{placeholder:"User name",ref:o}),r.a.createElement(w,{disabled:l,onClick:function(){o.current&&""!==o.current.value&&(Promise.resolve({name:o.current.value}).then((function(e){var t,a,r;return s.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.name,l.next=3,s.a.awrap(J({name:t}));case 3:return a=l.sent,r=a.token,O(r),l.next=8,s.a.awrap(ee({id:n.id}));case 8:i(!1),u();case 10:case"end":return l.stop()}}))})).catch((function(e){console.error(e),i(!1)})),i(!0))}},"Enter")))},Ce=Oe((function(e){var n=e.room,t=Object(Z.a)(e,["room"]);return n?n.gameActive?r.a.createElement(Ke,{room:n}):r.a.createElement(je,Object.assign({room:n},t)):r.a.createElement(u.a,{to:"/"})})),Le=Object(u.g)((function(e){return r.a.createElement(Ce,Object.assign({variables:{roomId:e.match.params.id}},e))})),Me=function(){return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",component:X}),r.a.createElement(u.b,{path:"/:id",component:Le}))},Te=function(){var e=r.a.useContext(z),n=e.viewer,t=e.update;if(null===n)throw new Error("Viewer is null");return r.a.createElement(h,null,r.a.createElement(R,null,r.a.createElement(E.h2,null,"Hello, ",n.name,"!"),r.a.createElement(o.b,{to:"/new"},r.a.createElement(w,null,"Create new room")),r.a.createElement(w,{onClick:function(){O(""),t()}},"Exit")))},De=Object(u.g)((function(e){var n=e.history,t=r.a.useContext(z),a=t.viewer,l=t.update,i=r.a.createRef(),o=r.a.useState(!1),u=Object(m.a)(o,2),c=u[0],d=u[1];if(null===a)throw new Error("Viewer is null");return r.a.createElement(h,null,r.a.createElement(R,null,r.a.createElement(E.h2,null,"Create new room"),r.a.createElement(x,{placeholder:"Room name",ref:i}),r.a.createElement(w,{onClick:function(e){e.preventDefault(),i.current&&""!==i.current.value&&(Promise.resolve({name:i.current.value}).then((function(e){var t,a,r;return s.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.name,i.next=3,s.a.awrap(Y({name:t}));case 3:a=i.sent,r=a.createRoom.id,d(!1),n.push("/"+r),l();case 8:case"end":return i.stop()}}))})).catch((function(e){console.error(e),d(!1)})),d(!0))},disabled:c}," Create room ")))})),Ue=function(){return r.a.createElement(h,null,r.a.createElement(E.h2,null,"Cant find room"))},Pe=function(e){var n=e.room;return r.a.createElement(h,null,r.a.createElement(E.h2,null,'Game in room "',n.name,'" has already started'))},qe=function(e){var n=e.room,t=r.a.useContext(z).update;return r.a.useEffect((function(){ee({id:n.id}).then((function(){return t()})).catch((function(e){return console.error(e)}))}),[t,n]),r.a.createElement(r.a.Fragment,null,"Please, wait...")},Ae=Oe((function(e){var n=e.room;return n?n.gameActive?r.a.createElement(Pe,{room:n}):r.a.createElement(qe,{room:n}):r.a.createElement(Ue,null)})),Be=Object(u.g)((function(e){return r.a.createElement(Ae,{variables:{roomId:e.match.params.id}})})),Qe=function(){return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",component:Te}),r.a.createElement(u.b,{path:"/new",component:De}),r.a.createElement(u.b,{path:"/:id",component:Be}))},Ie=function(){return t(193)},Ve=function(){return Q({mutation:Ie})},Ge=function(){var e=r.a.useContext(z),n=e.viewer,t=e.update,a=r.a.useState(!1),l=Object(m.a)(a,2),i=l[0],u=l[1];if(null===n)throw new Error("Viewer is null");var c=n.currentRoom;if(null===c)throw new Error("Current room is null");return r.a.createElement(h,null,r.a.createElement(R,null,r.a.createElement(E.h2,null,"Hello, ",n.name,"!"),r.a.createElement(o.b,{to:"/".concat(c.id),onClick:function(e){return i&&e.preventDefault()}},r.a.createElement(w,{disabled:i},'Return "',c.name,'"')),r.a.createElement(w,{disabled:i,onClick:function(){u(!0),Ve().then((function(){u(!1),t()}),(function(e){console.error(e),u(!1)}))}},"Exit room")))},Ne=Object(u.g)((function(e){var n=e.user,t=e.history,a=r.a.useContext(z),l=a.viewer,i=a.update;if(null===l)throw new Error("Viewer is null");var u=l.currentRoom;if(null===u)throw new Error("Current Room is null");var c=r.a.useState(!1),s=Object(m.a)(c,2),d=s[0],f=s[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.h2,null," ",n.name," left room. so you win."),r.a.createElement(R,null,r.a.createElement(o.b,{to:"/".concat(u.id),onClick:function(e){return d&&e.preventDefault()}},r.a.createElement(w,{disabled:d},"Wait here new game")),r.a.createElement(w,{disabled:d,onClick:function(){f(!0),Ve().then((function(){f(!1),t.push("/"),i()}),(function(e){console.error(e),f(!1)}))}},"Exit room")))})),$e=function(){return t(194)},ze=function(e){return r.a.createElement(te,{query:$e,render:function(n){var t=n.viewer,a=n.board;return t?a?r.a.createElement(Fe,Object.assign({viewer:t,board:a},e)):r.a.createElement(u.a,{to:"/".concat(t.currentRoom.id)}):r.a.createElement(u.a,{to:"/"})}})},We=function(){var e=r.a.useState(null),n=Object(m.a)(e,2),t=n[0],a=n[1];return r.a.createElement(h,null,t?r.a.createElement(Ne,t):r.a.createElement(ze,{onUserExit:a}))},Je=t(115),He=t.n(Je),Ye=function(){return t(219)},Xe=function(e){return Q({mutation:Ye,variables:{ready:e}})};function Ze(){var e=Object(d.a)(["\n  display: block;\n  margin: auto;\n  width: 20rem;\n  height: 20rem;\n"]);return Ze=function(){return e},e}var _e=f.a.img(Ze()),en=function(e){var n=e.data,t=r.a.useState(""),a=Object(m.a)(t,2),l=a[0],i=a[1];return r.a.useEffect((function(){He.a.toDataURL(n).then(i)}),[n]),r.a.createElement(_e,{src:l})},nn=function(){return t(220)},tn=Object(u.g)((function(e){var n=e.history,t=r.a.useContext(z).update;return r.a.useEffect((function(){var e=I({subscription:nn,onNext:function(e){return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.waitForOtherUserEnter.gameActive){a.next=4;break}return a.next=3,s.a.awrap(t());case 3:n.push("/game");case 4:case"end":return a.stop()}}))}}).dispose;return Xe(!0),function(){e(),Xe(!1)}})),r.a.createElement(h,null,r.a.createElement(E.h2,null,"Waiting for other player"),r.a.createElement(en,{data:window.location.href}))})),an=function(e){var n=e.currentRoom,t=e.targetRoom,a=r.a.useContext(z).update,l=r.a.useState(!1),i=Object(m.a)(l,2),u=i[0],c=i[1];return r.a.createElement(h,null,r.a.createElement(R,null,r.a.createElement(o.b,{to:"/".concat(n.id),onClick:function(e){return u&&e.preventDefault()}},r.a.createElement(w,{disabled:u},'Return to "',n.name,'"')),r.a.createElement(w,{disabled:u,onClick:function(){c(!0),Promise.resolve().then((function(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.awrap(Xe(!1));case 2:return e.next=4,s.a.awrap(Ve());case 4:return e.next=6,s.a.awrap(ee({id:t.id}));case 6:c(!1),a();case 8:case"end":return e.stop()}}))})).catch((function(e){console.error(e),c(!1)}))}},'Enter "',t.name,'"')))},rn=function(){return r.a.createElement(h,null,r.a.createElement(E.h2,null,"Cant find room"))},ln=function(e){var n=e.room;return r.a.createElement(h,null,r.a.createElement(E.h2,null,'Game in room "',n.name,'" has already started'))},on=function(e){var n=e.room,t=r.a.useContext(z).viewer;if(null===t)throw new Error("Viewer is null");var a=t.currentRoom;if(null===a)throw new Error("Current room is null");return a.id===n.id?n.gameActive?r.a.createElement(u.a,{to:"/game"}):r.a.createElement(tn,null):n.gameActive?r.a.createElement(ln,{room:n}):r.a.createElement(an,{currentRoom:a,targetRoom:n})},un=Oe((function(e){var n=e.room;return n?r.a.createElement(on,{room:n}):r.a.createElement(rn,null)})),cn=Object(u.g)((function(e){return r.a.createElement(un,{variables:{roomId:e.match.params.id}})})),sn=function(){return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",component:Ge}),r.a.createElement(u.b,{path:"/game",component:We}),r.a.createElement(u.b,{path:"/:id",component:cn}))},mn=function(){var e=r.a.useContext(z).viewer;if(null===e)throw new Error("Viewer is null");return null===e.currentRoom?r.a.createElement(Qe,null):r.a.createElement(sn,null)},dn=function(){return null===r.a.useContext(z).viewer?r.a.createElement(Me,null):r.a.createElement(mn,null)},fn=function(){return r.a.createElement($,null,r.a.createElement(o.a,null,r.a.createElement(dn,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(fn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[119,1,2]]]);
//# sourceMappingURL=main.6322568e.chunk.js.map